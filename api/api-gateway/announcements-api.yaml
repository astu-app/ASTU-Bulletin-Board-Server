openapi: 3.0.3
info:
  title: API Шлюз. Объявления
  description: API шлюза для управления объявлениями
  version: 0.0.1
servers:
  - url: 'https://localhost:8080'
paths:  
  # общие операции
  /announcements/create:
    post:
      tags: [ Общие операции ]
      operationId: createAnnouncement
      summary: Создать объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/announcement-schemas.yaml#/components/schemas/createAnnouncementDto'
      responses:
        201:
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # created
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/createAnnouncementResponses'
                  content:
                    $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementIdentifierDto'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # usergroupListNullOrEmpty
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/createAnnouncementResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/createAnnouncementResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementCreationForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/createAnnouncementResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementCategoriesDoNotExist
                    # filesDoNotExist
                    # surveyDoesNotExist
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/createAnnouncementResponses'
                  content:
                    $ref: './schemas/common-schemas.yaml#/components/schemas/identifiers'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # attachingFilesAndSurveyTogether 
                    # automaticPublishMomentIsInPast
                    # automaticHideMomentIsInPast
                    # autoHidingAnAlreadyHiddenAnnouncement
                    # autoPublishingPublishedAndNonHiddenAnnouncement
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/createAnnouncementResponses'
  
  /announcements/get-details:
    get:
      tags: [ Общие операции ]
      operationId: getAnnouncementDetails
      summary: Получить подробности о выбранном объявлении
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementDetailsDto'
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getAnnouncementDetailsResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getAnnouncementDetailsResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getAnnouncementDetailsResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # detailsAccessForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getAnnouncementDetailsResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementDoesNotExist
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getAnnouncementDetailsResponses'
  
  /announcements/update:
    put:
      tags: [ Общие операции ]
      operationId: updateAnnouncement
      summary: Редактировать объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/announcement-schemas.yaml#/components/schemas/updateAnnouncementDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/updateAnnouncementResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # usergroupListNullOrEmpty
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/updateAnnouncementResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/updateAnnouncementResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementEditingForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/updateAnnouncementResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementDoesNotExist
                    # announcementCategoriesDoNotExist
                    # filesDoNotExist
                    # surveyDoesNotExist
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/updateAnnouncementResponses'
                  content:
                    $ref: './schemas/common-schemas.yaml#/components/schemas/identifiers'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # attachingFilesAndSurveyTogether
                    # automaticPublishMomentIsInPast
                    # automaticHideMomentIsInPast
                    # 
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/updateAnnouncementResponses'
  
  /announcements/delete:
    delete:
      tags: [ Общие операции ]
      operationId: deleteAnnouncement
      summary: Удалить объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/deleteAnnouncementResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/deleteAnnouncementResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/deleteAnnouncementResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementDeletionForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/deleteAnnouncementResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementDoesNotExist
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/deleteAnnouncementResponses'
  
  # опубликованные объявления  
  /announcements/posted/get-list:
    get:
      tags: [ Опубликованные объявления ]
      operationId: getPostedAnnouncementList
      summary: Получить список опубликованных объявлений
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementSummaryDto'
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getPostedAnnouncementListResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getPostedAnnouncementListResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # postedAnnouncementsListAccessForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getPostedAnnouncementListResponses'
  
  /announcements/posted/hide:
    post:
      tags: [ Опубликованные объявления ]
      operationId: hidePostedAnnouncement
      summary: Скрыть опубликованное объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/hidePostedAnnouncementResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/hidePostedAnnouncementResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/hidePostedAnnouncementResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementHidingForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/hidePostedAnnouncementResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementDoesNotExist
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/hidePostedAnnouncementResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementAlreadyHidden
                    # announcementNotYetPublished
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/hidePostedAnnouncementResponses'
  
  # скрытые объявления
  /announcements/hidden/get-list:
    get:
      tags: [ Скрытые объявления ]
      operationId: getHiddenAnnouncementList
      summary: Получить список скрытых объявлений
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementSummaryDto'
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getHiddenAnnouncementListResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getHiddenAnnouncementListResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # hiddenAnnouncementsListAccessForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getHiddenAnnouncementListResponses'
  
  /announcements/hidden/unhide:
    post:
      tags: [ Скрытые объявления ]
      operationId: unhideHiddenAnnouncement
      summary: Восстановить скрытое объявление
      requestBody:
        content:
          application/json:
            schema:
              $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/unhideHiddenAnnouncementResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/unhideHiddenAnnouncementResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/unhideHiddenAnnouncementResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unhideForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/unhideHiddenAnnouncementResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementDoesNotExist
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/unhideHiddenAnnouncementResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementNotHidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/unhideHiddenAnnouncementResponses'
  
  # отложенные объявления
  /announcements/delayed/get-list:
    get:
      tags: [ Отложенные объявления ]
      operationId: getDelayedAnnouncementList
      summary: Получить список отложенных объявлений
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementSummaryDto'
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getDelayedAnnouncementListResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getDelayedAnnouncementListResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # delayedAnnouncementsListAccessForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/getDelayedAnnouncementListResponses'
  
  /announcements/delayed/publish-immediately:
    post:
      tags: [ Отложенные объявления ]
      operationId: publishImmediatelyDelayedAnnouncement
      summary: Сразу опубликовать отложенное объявление
      requestBody:
        content:
          application/json:
            schema:
              $ref: './schemas/announcement-schemas.yaml#/components/schemas/announcementIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedAnnouncementResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedAnnouncementResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedAnnouncementResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # immediatePublishingForbidden
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedAnnouncementResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementDoesNotExist
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedAnnouncementResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # announcementNotDelayed
                    $ref: './schemas/responses/announcement-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedAnnouncementResponses'
        
        