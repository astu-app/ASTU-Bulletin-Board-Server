openapi: 3.0.3
info:
  title: API Шлюз. Объявления
  description: API шлюза для управления объявлениями
  version: 0.0.1
servers:
  - url: 'https://localhost:8080'
paths:  
  # общие операции
  /notifications/create:
    post:
      tags: [ Общие операции ]
      operationId: createNotification
      summary: Создать объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/notification-schemas.yaml#/components/schemas/createNotificationDto'
      responses:
        201:
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/createNotificationResponses'
                  content:
                    # created
                    $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationIdentifierDto'
        400: 
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties: 
                  code:
                    # usergroupListNullOrEmpty
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/createNotificationResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/createNotificationResponses'
        403:
          description: Forbidden
          content: 
            application/json:
              schema:
                type: object
                properties:
                  code: 
                    # notificationCreationForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/createNotificationResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # fileDoesNotExist
                    # surveyDoesNotExist
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/createNotificationResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # cannotAttachFilesAndSurveyTogether
                    # automaticHideBeforePublication
                    # delayedPublicationBeforeCreation
                    # delayedPublicationAfterAutomaticHide
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/createNotificationResponses'
  
  /notifications/get-details:
    get:
      tags: [ Общие операции ]
      operationId: getNotificationDetails
      summary: Получить подробности о выбранном объявлении
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties: 
                  content:
                    $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationDetailsDto'
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getNotificationDetailsResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties: 
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getNotificationDetailsResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getNotificationDetailsResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # detailsAccessForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getNotificationDetailsResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationDoesNotExist
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getNotificationDetailsResponses'
  
  /notifications/update:
    put:
      tags: [ Общие операции ]
      operationId: updateNotification
      summary: Редактировать объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/notification-schemas.yaml#/components/schemas/updateNotificationDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties: 
                  content:
                    $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationIdentifierDto'
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/updateNotificationResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties: 
                  code:
                    # usergroupListNullOrEmpty
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/updateNotificationResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/updateNotificationResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationEditingForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/updateNotificationResponses'
        404:
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationDoesNotExist
                    # fileDoesNotExist
                    # surveyDoesNotExist
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/updateNotificationResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # cannotAttachFilesAndSurveyTogether
                    # automaticHideBeforePublication
                    # delayedPublicationBeforeCreation
                    # delayedPublicationAfterAutomaticHide
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/updateNotificationResponses'
  
  /notifications/delete:
    delete:
      tags: [ Общие операции ]
      operationId: deleteNotification
      summary: Удалить объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationIdentifierDto'
      responses:
        200:
          description: Ok
          content: 
            application/json:
              schema: 
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/deleteNotificationResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/deleteNotificationResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/deleteNotificationResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationDeletionForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/deleteNotificationResponses'
        404:
          description: Not Found
          content: 
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationDoesNotExist
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/deleteNotificationResponses'
  
  # опубликованные объявления  
  /notifications/posted/get-list: # todo учесть получение ограниченного набора
    get:
      tags: [ Опубликованные объявления ]
      operationId: getPostedNotificationList
      summary: Получить список опубликованных объявлений
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties: 
                  content:
                    type: array
                    items:
                      $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationSummaryDto'
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getPostedNotificationListResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getPostedNotificationListResponses'
        403:
          description: Forbidden
          content: 
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # postedNotificationsListAccessForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getPostedNotificationListResponses'
  
  /notifications/posted/hide:
    post:
      tags: [ Опубликованные объявления ]
      operationId: hidePostedNotification
      summary: Скрыть опубликованное объявление
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema: 
                type: object
                properties: 
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/hidePostedNotificationResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/hidePostedNotificationResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/hidePostedNotificationResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationHidingForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/hidePostedNotificationResponses'
        404:
          description: Not Found
          content: 
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationDoesNotExist
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/hidePostedNotificationResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationAlreadyHidden
                    # notificationNotYetPublished
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/hidePostedNotificationResponses'
  
  # скрытые объявления
  /notifications/hidden/get-list: # todo учесть получение ограниченного набора 
    get:
      tags: [ Скрытые объявления ]
      operationId: getHiddenNotificationList
      summary: Получить список скрытых объявлений
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationSummaryDto'
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getHiddenNotificationListResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getHiddenNotificationListResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # hiddenNotificationsListAccessForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getHiddenNotificationListResponses'
  
  /notifications/hidden/unhide:
    post:
      tags: [ Скрытые объявления ]
      operationId: unhideHiddenNotification
      summary: Восстановить скрытое объявление
      requestBody:
        content:
          application/json:
            schema:
              $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/unhideHiddenNotificationResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/unhideHiddenNotificationResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/unhideHiddenNotificationResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unhideForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/unhideHiddenNotificationResponses'
        404:
          description: Not Found
          content: 
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationDoesNotExist
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/unhideHiddenNotificationResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationNotHidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/unhideHiddenNotificationResponses'
  
  # отложенные объявления
  /notifications/delayed/get-list: # todo учесть получение ограниченного набора
    get:
      tags: [ Отложенные объявления ]
      operationId: getDelayedNotificationList
      summary: Получить список отложенных объявлений
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationSummaryDto'
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getDelayedNotificationListResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getDelayedNotificationListResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # delayedNotificationsListAccessForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/getDelayedNotificationListResponses'
  
  /notifications/delayed/publish-immediately:
    post:
      tags: [ Отложенные объявления ]
      operationId: publishImmediatelyDelayedNotification
      summary: Сразу опубликовать отложенное объявление
      requestBody:
        content:
          application/json:
            schema:
              $ref: './schemas/notification-schemas.yaml#/components/schemas/notificationIdentifierDto'
      responses:
        200:
          description: Ok
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # ok
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedNotificationResponses'
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # incorrectIdentifierFormat
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedNotificationResponses'
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # unauthorized
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedNotificationResponses'
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # immediatePublishingForbidden
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedNotificationResponses'
        404:
          description: Not Found
          content: 
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationDoesNotExist
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedNotificationResponses'
        409:
          description: Conflict
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    # notificationNotDelayed
                    $ref: './schemas/responses/notification-enum-response-schemas.yaml#/components/schemas/publishImmediatelyDelayedNotificationResponses'
      
      